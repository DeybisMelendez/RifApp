{% extends "layout.html" %}
{% block title %}Sorteo {{ raffle.prize_name }}{% endblock %}

{% block content %}
  <h1>{{ raffle.prize_name }}</h1>
  <article>
    <section>
      <p>{{ raffle.prize_description|default:"Sin descripción disponible." }}</p>
      {% if raffle.prize_image %}
        <img src="{{ raffle.prize_image.url }}" alt="Prize image">
      {% else %}
        <p><em>Sin imagen del premio.</em></p>
      {% endif %}
    </section>

    <hr>

    {% if raffle.finalized and winner %}
    <section>
      <h2>🏆 ¡Tenemos un ganador!</h2>
      <p>
        🎉 Felicitaciones a <strong>{{ winner.participant.name }}</strong> 🎉  
        por ganar el premio <em>{{ raffle.prize_name }}</em> con el número 
        <strong>#{{ winner.number|add:"0"|slice:"-2" }}</strong>.
      </p>
    </section>
    <hr>
    {% endif %}

    <section>
      <h2>🎟️ Números Asignados</h2>
      {% if assigned_numbers %}
        <table role="grid">
          <thead>
            <tr>
              <th>Número</th>
              <th>Participante</th>
              <th>Registrado</th>
            </tr>
          </thead>
          <tbody>
            {% for number in assigned_numbers %}
            <tr>
              <td># {{ number.number }}</td>
              <td>{{ number.participant.name }}</td>
              <td>{{ number.created_at }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p>No hay números asignados aún.</p>
      {% endif %}
    </section>

    <hr>

    <section>
      <h2>🔢 Números Disponibles ({{ available_numbers|length }})</h2>
      {% if available_numbers %}
        <div style="display: flex; flex-wrap: wrap; gap: 0.4rem;">
          {% for num in available_numbers %}
            <span style="padding: 0.3rem 0.5rem; border-radius: 4px; background: var(--muted-border-color);">
              {{ num|add:"0"|slice:"-2" }}
            </span>
          {% endfor %}
        </div>
      {% else %}
        <p><em>Todos los números han sido asignados.</em></p>
      {% endif %}
    </section>
  </article>
{% endblock %}
